<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Big idea | gapclosing: An R package</title>
<meta name="author" content="Ian Lundberg (ilundberg@cornell.edu)">
<meta name="description" content="This part introduces the big ideas: why we should do this, what data look like, and what’s going on under the hood. It closes with basic package functionality.  2.1 Motivation Gaps across social...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 2 Big idea | gapclosing: An R package">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ilundberg.github.io/gapclosing/github_doc/index.html/big-idea.html">
<meta property="og:description" content="This part introduces the big ideas: why we should do this, what data look like, and what’s going on under the hood. It closes with basic package functionality.  2.1 Motivation Gaps across social...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Big idea | gapclosing: An R package">
<meta name="twitter:description" content="This part introduces the big ideas: why we should do this, what data look like, and what’s going on under the hood. It closes with basic package functionality.  2.1 Motivation Gaps across social...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">gapclosing: An R package</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> gapclosing: An R package</a></li>
<li><a class="active" href="big-idea.html"><span class="header-section-number">2</span> Big idea</a></li>
<li><a class="" href="concepts-in-detail.html"><span class="header-section-number">3</span> Concepts in detail</a></li>
<li><a class="" href="machine-learning-examples.html"><span class="header-section-number">4</span> Machine learning examples</a></li>
<li><a class="" href="advanced-treatment-assignments.html"><span class="header-section-number">5</span> Advanced treatment assignments</a></li>
<li><a class="" href="conclusion.html"><span class="header-section-number">6</span> Conclusion</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="big-idea" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Big idea<a class="anchor" aria-label="anchor" href="#big-idea"><i class="fas fa-link"></i></a>
</h1>
<p>This part introduces the big ideas: why we should do this, what data look like, and what’s going on under the hood. It closes with basic package functionality.</p>
<div id="motivation" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Motivation<a class="anchor" aria-label="anchor" href="#motivation"><i class="fas fa-link"></i></a>
</h2>
<p>Gaps across social categories like race, class, and gender are important to understand. We would like to know whether there is anything we can do to close these gaps. What if we intervened to reduce incarceration or increase access to education? Would those interventions close gaps across categories of race, class, or gender?</p>
<p>These types of questions are at the core of a growing literature in epidemiology addresses these questions with techniques for causal decomposition analysis (<span class="citation">VanderWeele and Robinson (<a href="references.html#ref-vanderweele2014" role="doc-biblioref">2014</a>)</span>, <span class="citation">Jackson and VanderWeele (<a href="references.html#ref-jackson2018" role="doc-biblioref">2018</a>)</span>, <span class="citation">Jackson (<a href="references.html#ref-jackson2020" role="doc-biblioref">2020</a>)</span>). The paper which accompanies this software package introduces these methods to a broader set of social scientists.</p>
<blockquote>
<p>Lundberg, Ian. 2022. “The gap-closing estimand: A causal approach to study interventions that close disparities across social categories.” <em>Sociological Methods and Research</em>. <a href="https://doi.org/10.1177/00491241211055769">[published version]</a> <a href="https://doi.org/10.31235/osf.io/gx4y3">[open access preprint]</a> <a href="https://ilundberg.github.io/gapclosing/">[software]</a>.</p>
</blockquote>
<p>This package provides software to support inquiry into gap-closing estimands. A guiding principle is to partition the tasks the human user must do from the tasks that the package can automate.</p>
<p>The human user must carry out these tasks:</p>
<ul>
<li>Define the intervention</li>
<li>Make causal assumptions for identification</li>
<li>Specify a treatment model and/or an outcome model</li>
</ul>
<p>Given those inputs, the package will automatically:</p>
<ul>
<li>Estimate models (GLM, GAM, ridge regression, or random forest)</li>
<li>Convert models to doubly-robust estimates of gap-closing estimands, using sample splitting to improve convergence</li>
<li>Estimate standard errors by bootstrapping</li>
<li>Visualize the result</li>
</ul>
</div>
<div id="data-structure" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Data structure<a class="anchor" aria-label="anchor" href="#data-structure"><i class="fas fa-link"></i></a>
</h2>
<p>In a data frame <code>data</code>, we have a gap-defining category such as race, gender, or class. We have a binary treatment variable that could have counterfactually been different for any individual. We want to know the degree to which an intervention to change the treatment would close gaps across the categories.</p>
<blockquote>
<p><strong>These boxes will present an example.</strong></p>
<p><em>Example.</em> Suppose we have the following data.</p>
<ul>
<li>
<span class="math inline">\(X\)</span> (<code>category</code>): Category of interest, taking values {A, B, C}</li>
<li>
<span class="math inline">\(T\)</span> (<code>treatment</code>): Binary treatment variable, taking values 0 and 1</li>
<li>
<span class="math inline">\(L\)</span> (<code>confounder</code>): A continuous confounding variable, Uniform(-1,1)</li>
<li>
<span class="math inline">\(Y\)</span> (<code>outcome</code>): A continuous outcome variable, conditionally normal</li>
</ul>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">08544</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ilundberg.github.io/gapclosing/">gapclosing</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gapclosing/man/generate_simulated_data.html">generate_simulated_data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">simulated_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   category confounder treatment    outcome</span></span>
<span><span class="co">#&gt; 1        C   1.640509         1 -0.7970377</span></span>
<span><span class="co">#&gt; 2        B   1.032373         0  1.9304909</span></span>
<span><span class="co">#&gt; 3        C   2.217630         1 -0.2009803</span></span>
<span><span class="co">#&gt; 4        A  -1.642914         0 -0.5015702</span></span>
<span><span class="co">#&gt; 5        A  -1.844897         0 -1.2027025</span></span>
<span><span class="co">#&gt; 6        A  -2.415100         0 -3.9288188</span></span></code></pre></div>
</div>
<div id="coding-from-scratch" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Coding from scratch<a class="anchor" aria-label="anchor" href="#coding-from-scratch"><i class="fas fa-link"></i></a>
</h2>
<p>With the most simple models, you can carry out a gap-closing analysis without the software package. First, fit any prediction function for the outcome as a function of the category of interest, confounders, and treatment.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">category</span><span class="op">*</span><span class="va">treatment</span> <span class="op">+</span> <span class="va">confounder</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">simulated_data</span><span class="op">)</span></span></code></pre></div>
<p>For everyone in the sample, predict under a counterfactual treatment value (e.g., <code>treatment = 1</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitted</span> <span class="op">&lt;-</span> <span class="va">simulated_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>outcome_under_treatment_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">example_ols</span>,</span>
<span>                                             newdata <span class="op">=</span> <span class="va">simulated_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>                                               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Average the counterfactual estimates within each category.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitted</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Group by the category of interest</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">category</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Take the average prediction</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>factual <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span>,</span>
<span>            counterfactual <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">outcome_under_treatment_1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span><span class="co">#&gt;   category factual counterfactual</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 A        -1.09           0.0488</span></span>
<span><span class="co">#&gt; 2 B        -0.0384        -0.0370</span></span>
<span><span class="co">#&gt; 3 C         0.495          0.132</span></span></code></pre></div>
<p>The software package supports these steps as well as more complex things you might want:</p>
<ul>
<li>three estimation strategies
<ul>
<li>outcome prediction</li>
<li>treatment prediction</li>
<li>doubly robust estimation</li>
</ul>
</li>
<li>machine learning prediction functions</li>
<li>counterfactual treatments that differ across units</li>
<li>bootstrapping for standard errors</li>
<li>easy visualization</li>
</ul>
</div>
<div id="basic-package-functionality" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Basic package functionality<a class="anchor" aria-label="anchor" href="#basic-package-functionality"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/pkg/gapclosing/man/gapclosing.html">gapclosing()</a></code> function estimates gaps across categories and the degree to which they would close under the specified <code>counterfactual_assignments</code> of the treatment.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gapclosing/man/gapclosing.html">gapclosing</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simulated_data</span>,</span>
<span>  counterfactual_assignments <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  outcome_formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">confounder</span> <span class="op">+</span> <span class="va">category</span><span class="op">*</span><span class="va">treatment</span><span class="op">)</span>,</span>
<span>  treatment_formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">~</span> <span class="va">confounder</span> <span class="op">+</span> <span class="va">category</span><span class="op">)</span>,</span>
<span>  category_name <span class="op">=</span> <span class="st">"category"</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Setting bootstrap_samples very low to speed this tutorial</span></span>
<span>  <span class="co"># Should be set higher in practice</span></span>
<span>  bootstrap_samples <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  <span class="co"># You can process the bootstrap in parallel with as many cores as available</span></span>
<span>  parallel_cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>By default, this function will do the following:</p>
<ul>
<li>Fit logistic regression to predict treatment assignment</li>
<li>Fit OLS regression to predict outcomes</li>
<li>Combine the two in a doubly-robust estimator estimated on a single sample</li>
<li>Return a <code>gapclosing</code> object which supports <code>summary</code>, <code>print</code>, and <code>plot</code> functions.</li>
</ul>
<p>In this example, the <code>plot(estimate)</code> function produces the following visualization. The factual outcomes are unequal across categories, but the counterfactual outcomes are roughly equal. In this simulated setting, the intervention almost entirely closes the gaps across the categories.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="github_doc_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
<p>The <code><a href="https://rdrr.io/pkg/gapclosing/man/disparityplot.html">disparityplot()</a></code> function lets us zoom in on the factual and counterfactual disparity between two categories, of interest. In this case, we see that the intervention lifts outcomes in category A to be more comparable to category B. A <code>disparityplot</code> is a <code>ggplot2</code> object and can be customized by passing additional layers.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gapclosing/man/disparityplot.html">disparityplot</a></span><span class="op">(</span><span class="va">estimate</span>, category_A <span class="op">=</span> <span class="st">"A"</span>, category_B <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"A disparityplot()"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="github_doc_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
<p>The <code>summary</code> function will print estimates, standard errors, and confidence intervals for all of these results.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></span>
<span><span class="co">#&gt; Gap-closing estimates using doubly_robust estimation on one sample.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Treatment model was glm estimation with model formula:</span></span>
<span><span class="co">#&gt; formula(treatment ~ confounder + category)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Outcome model was lm estimation with model formula:</span></span>
<span><span class="co">#&gt; formula(outcome ~ confounder + category * treatment)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Factual estimates are means within and disparities across category.</span></span>
<span><span class="co">#&gt; Counterfactual estimates are under an intervention to set  to 1.</span></span>
<span><span class="co">#&gt; Standard errors are calculated from 20 bootstrap samples.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Factual mean outcomes:</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 5</span></span>
<span><span class="co">#&gt;   category estimate     se ci.min ci.max</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 A         -1.09   0.113  -1.31  -0.870</span></span>
<span><span class="co">#&gt; 2 B         -0.0384 0.0794 -0.194  0.117</span></span>
<span><span class="co">#&gt; 3 C          0.495  0.0900  0.319  0.672</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Counterfactual mean outcomes (post-intervention means):</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 5</span></span>
<span><span class="co">#&gt;   category estimate    se ci.min ci.max</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 A         -0.102  0.175 -0.445  0.241</span></span>
<span><span class="co">#&gt; 2 B          0.0409 0.122 -0.197  0.279</span></span>
<span><span class="co">#&gt; 3 C          0.0805 0.121 -0.157  0.318</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Factual disparities:</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   category estimate    se ci.min ci.max</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 A - B      -1.05  0.141 -1.33  -0.777</span></span>
<span><span class="co">#&gt; 2 A - C      -1.59  0.151 -1.88  -1.29 </span></span>
<span><span class="co">#&gt; 3 B - A       1.05  0.141  0.777  1.33 </span></span>
<span><span class="co">#&gt; 4 B - C      -0.534 0.111 -0.751 -0.317</span></span>
<span><span class="co">#&gt; 5 C - A       1.59  0.151  1.29   1.88 </span></span>
<span><span class="co">#&gt; 6 C - B       0.534 0.111  0.317  0.751</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Counterfactual disparities (gap-closing estimands):</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   category estimate    se ci.min ci.max</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 A - B     -0.143  0.249 -0.631  0.345</span></span>
<span><span class="co">#&gt; 2 A - C     -0.183  0.228 -0.629  0.264</span></span>
<span><span class="co">#&gt; 3 B - A      0.143  0.249 -0.345  0.631</span></span>
<span><span class="co">#&gt; 4 B - C     -0.0396 0.161 -0.356  0.277</span></span>
<span><span class="co">#&gt; 5 C - A      0.183  0.228 -0.264  0.629</span></span>
<span><span class="co">#&gt; 6 C - B      0.0396 0.161 -0.277  0.356</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Additive gap closed: Counterfactual - Factual</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   category estimate     se ci.min ci.max</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 A - B      -0.909 0.170  -1.24  -0.576</span></span>
<span><span class="co">#&gt; 2 A - C      -1.40  0.156  -1.71  -1.10 </span></span>
<span><span class="co">#&gt; 3 B - A       0.909 0.170   0.576  1.24 </span></span>
<span><span class="co">#&gt; 4 B - C      -0.494 0.0931 -0.677 -0.312</span></span>
<span><span class="co">#&gt; 5 C - A       1.40  0.156   1.10   1.71 </span></span>
<span><span class="co">#&gt; 6 C - B       0.494 0.0931  0.312  0.677</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Proportional gap closed: (Counterfactual - Factual) / Factual</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   category estimate    se ci.min ci.max</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 A - B       0.864 0.296  0.284   1.44</span></span>
<span><span class="co">#&gt; 2 A - C       0.885 0.142  0.607   1.16</span></span>
<span><span class="co">#&gt; 3 B - A       0.864 0.296  0.284   1.44</span></span>
<span><span class="co">#&gt; 4 B - C       0.926 0.261  0.414   1.44</span></span>
<span><span class="co">#&gt; 5 C - A       0.885 0.142  0.607   1.16</span></span>
<span><span class="co">#&gt; 6 C - B       0.926 0.261  0.414   1.44</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type plot(name_of_this_object) to visualize results.</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html"><span class="header-section-number">1</span> gapclosing: An R package</a></div>
<div class="next"><a href="concepts-in-detail.html"><span class="header-section-number">3</span> Concepts in detail</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#big-idea"><span class="header-section-number">2</span> Big idea</a></li>
<li><a class="nav-link" href="#motivation"><span class="header-section-number">2.1</span> Motivation</a></li>
<li><a class="nav-link" href="#data-structure"><span class="header-section-number">2.2</span> Data structure</a></li>
<li><a class="nav-link" href="#coding-from-scratch"><span class="header-section-number">2.3</span> Coding from scratch</a></li>
<li><a class="nav-link" href="#basic-package-functionality"><span class="header-section-number">2.4</span> Basic package functionality</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/02-big-idea.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/02-big-idea.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>gapclosing: An R package</strong>" was written by Ian Lundberg (<a href="mailto:ilundberg@cornell.edu" class="email">ilundberg@cornell.edu</a>). It was last built on 2023-03-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
